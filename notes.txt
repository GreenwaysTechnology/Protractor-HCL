Node.js
-------
-->It is javascript runtime, used to run java script applications outside web browser
->it is written on google v8, which is called javascript runtime.

what is objective of node.js?

1.To network nonblocking and async  web applications.
    ->To scale hori - min resources, high performance.

Node use cases:

1. Build javascript applications for web,network based application.
2. Used to run as a platform for building other application- UI,Mobile Applications...
3. Used as Testing engine - /Testing platform - How to test javascript javascript application.

Javascript Application:

js was created for manipulating web pages  - :  DOM programming.

After node:

javascript has been used to build

1.server side applications : restfull webservices,dynamic content generation application
2.User interface applications-SPA - back bone,Angular js(1),Angular-2,4,5,6,7,8,9(Typescript)
                                    React.js, Vue.js......
3.Mobile Apps - Angular -ionic,React Native......
4.Device apps -
5.Machine learning,AI

What ever type of app, we need to test. in order test applications we need testing frameworks

Software env:

1.dev
2.testing
3.Prod

in order to set any env, we need platform - Node.js

Node and testing env:
....................


                            Testing Apps
                                |	

	Mocha,jasmine      --------Testing Engine-Javascript program-Frameworks
				 |
			       Node.js - platform
				 |
				 OS
********************************************************************************************

basic knowledge on javascript.
node  applications -  node modules
javascript package manager - npm.

functions- args,parameters,return values
async programming - callbacks,promise,async,await

*******************************************************************************************
How enter prise javascript application ; modualrity.

 breaking application into smaller and smaller , how to combine and them run them.

js has no any modular patterns.

js community brought modular design patterns.

1.namespace -old
2.amd-
3.cjs - which is used in node applications even today
4.e6 modules- ecma pattern
5.system
6.umd

cjs:
 - how to write code and how link code and how distribute them.

Linking
 cjs provides simple function  name called "require"

sharing
 exports : packs any code inside an object and that object will be returned.

 module.exports :
  it does not add code inside object , rather it returns as it is-  
  lets say if you return function, it returns function.


Types of modules:

1.custom modules : you have created.
2.node in built modules : provided by node, for building network , io applications.
3.third party modules ; provided by community.
    eg : jasmin,protractor,chai,should,blanket..........angular,react,vue,express....
-->npm


Third party modules:

 The module is built and distributed by person/company/community to others.

you need a centeralized location  , repository server - https://www.npmjs.com/

npmjs.com is one the biggest software repository ever.

if you want to use any third party module, you need to download loacally from this repository.
if you want to publish modules.


in order to deal with third party modules, you need tool called "npm / npmx".

npm tool is distributed along with node distribution.

 ->npm --version

npm -node package manager 
 tool.

where we can download node-moudles from npmjs.com?

->node_modules
    -it is folder where all third party javascript files- libs,frameworks.

where you can find out this folder?

 -> inside project
 -> inside c/ drive - gobal modlues

how to create this folder?

 folder is first created when you download any modules.


project meta file: package.json
   configuration file.

This is file , for keeping javascript apps(any type)

Every node project must have package.json file.

how to create it?
  npm command

npm init

{
  "name": "mynode-apps",
  "version": "1.0.0",
  "description": "This is pre learning for Protractor",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "author": "Subramanian Murugan",
  "license": "ISC"
}
*******************************************************************************************

Node Modules category:

->For development and Production 
->For development only - testing dependencies.
->For development/Testing/Production tooling - tools for automation, testing.....

if any category, you can download and install.

  npm install modulename --category(options)
  npm install modulename  
 options
   --save  :  dev+production
   --save-dev :  only for dev/test/tool
   --global /g  :  only for tooling

->For development and Production:
 npm install modulename  --save
 
package.json
"dependencies": {
    "lodash": "^4.17.19"
  }

//use third party dependencies

var _ =require('lodash');

var users = [
    { 'user': 'barney', 'age': 36, 'active': false },
    { 'user': 'fred',   'age': 40, 'active': true }
  ];

var result =_.filter(users, function(o) { return !o.active; });

console.log(result);

how to unistall modules:
.........................
>npm uninstall jquery --save
********************************************************************************************

dev depedencies:

 npm install modulename --save-dev

eg:
 Unit testing assertion lib.

chai
npm install chai --save-dev

 "devDependencies": {
    "chai": "^4.2.0"
  }
********************************************************************************************
 require('module') vs require('./module')

 if require('module') , node internally uses a search algorthim, which searches node modules
 
  --->project node_modules
		  |
                 if found , it will load from there
                   |
                    if not found
			 |
			c/users/.../node_modules folder
				
                            |
			 if found, load from here
			    |
                            if not ,it will throw error-module not found 




require('./module')
         it searches the current project folder


**********************************************************************************************

Global modules :  used for tool purpose.

 - build tools
 - compilers
 - Testing runtimes- Mocha,Jasmine,Protractor
 - Servers - ready made webservers,testing servers,automation servers
.....

 npm install module -g

Eg:

 mocha -

npm install mocha -g

C:\Users\sasub\AppData\Roaming\npm

mocha --version
8.0.1
*********************************************************************************************
automation: running scripts , which executes some tasks
.............................................................................................

in node applications, automation is taken care by npm tool.

how to start automation?
 -package.json , there is an entry 

  "scripts"

 key: value

 key : command name
 value : task to be executed

 eg : if i want to application, through automation.

note: 
 command name is provided by npm itself : built in commands
  eg: start,test,......
 command also be user defined.
  xxx,

 "scripts": {
    "start" : "node src/index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  }

how to run?

 npm start ---npm commandName

 npm run commandName - for user defined

 "scripts": {
    "start" : "node src/index.js",
    "build": "node src/index.js",
    "test": "echo \"Error: no test specified\" && exit 1"
  }

Global Modules and problems;
...........................

1.version mismatch for across many projects

install all the tools as "dev-dependencies' inside project


--
npm install mocha --save-dev

configure this inside scripts section: testing automation.
*********************************************************************************************
Async programming and its implementation:

 -callbacks
 -promises
 -async .. await keywords

What is async programming?


conncurrency:

Most of the programming languages - jvm is multi threaded
javascript is not multithread - single thread.

How to write async programming?

Rules:

1.async apis should be provided by node/js.
 -eg:
   timers - settimeout,setinterval
   file system - to read and write files
   networking apis-  tcp/ip , http
  etc.....

2.Handlers - functions , to handle/read async operation results -  callbacks
  callbacks are just function which are passed as parameter to async api.



//async programming.

//using timer

function  delay(callback){
  setTimeout(callback,1000);
}
console.log('start')
delay(function handler(){
    console.log('Delay');
});
console.log('end');

//
function handle(handler){
    setTimeout(handler,2000,"Welcome to Non blocking World!!!")
}

handle(function handler(data){
    console.log(data);
});
*****************************************************************************************

Problems with callback : CallbackHell

//callback nesting
//the output of one callback, will be input to another callback.
///any code will have two things : 1. success(resolve), 2.failure(rejections)
//getuser---success---login(user,success,failure)---|
//getUser---failure --error---Stop


function getUser(resolve,reject){
 //mock data
  var user = 'admin';
  var errorMessage = 'User Not Found!';
  if(user){
        setTimeout(resolve,1000,user);
  }else{
       setTimeout(reject,1000,errorMessage)
  }

}
function login(user,resolve,reject){
    var errorMessage = 'Login failed';
    var successMessage ='Login success';
    if(user === 'admin'){
          setTimeout(resolve,1000,successMessage);
    }else{
         setTimeout(reject,1000,errorMessage)
    }
   
}

//caller
getUser(function(user){
    console.log('User api is called')
    //callback nesting
     login(user,function(success){
       console.log(success)        
     },function(failure){
        console.log(failure);
     });
} , function(err){
   console.log(err);
})

if you look at the above code ask your self

1.code is readable?
2.code is maintainable
3.code is scalable
 
No :  this is called as "callback hell"

how to fix callback hell, how to write good code?
->Ans : Promise

What is promise?

 Promise is design pattern , introduced to avoid callback hell. 

Since it is design pattern, we need implementation.

many vendors started writing promises

1.jquery
2.many vendors

3.In 2012 , js community who added promises in language itself as 
Object.

 Promise Object
..................

Promise object can be created in two ways

1.Factory api
   
2.using Constructors 

Note : By default Promise is async, which internally implments timer with 0 ms.


methods :
 1.resolve
 2.reject
 3.then
 4.catch
 5.finally
 etc...
//Promise
/**
 * 1.create Promise object using factory apis
 * 
 */

 //callback success only
//  function getData(callback){
//    setTimeout(callback,0,"some data");
//  }
//  getData(function(data){
//      console.log(data)
//  })

//Promise success only
function getData(){
    return Promise.resolve('Some data');
}
console.log('start')
getData().then(function(res){
    console.log(res);
});
console.log('end');

//error only
function getError(){
    return Promise.reject('Some error');
}
getError().catch(function(res){
    console.log(res);
});

//how to return success/failure

function getUser(){
    //mock data
     var user = 'admin';
     var errorMessage = 'User Not Found!';
     if(user){
          return Promise.resolve(user)
     }
     return Promise.reject(errorMessage)   
   
}

function login(user){
    var errorMessage = 'Login failed';
    var successMessage ='Login success';
    if(user === 'admin'){
        return Promise.resolve(successMessage)
    }
    return Promise.reject(errorMessage)      
}
getUser()
  .then(function(res){
      console.log('user api is called!!!');
      return login(res)
  })
  .then(function(res){
      console.log(res)
  })
  .catch(function(res){
    console.log(res);
 })
 .finally(function(){
     console.log('finally')
 });
//////////////////////////////////////////////////////////////////////////////////
//Promise constructors : to convert exsiting callback apis to promise powered.

function getCustomer(){
    //mock data
     var user = 'customer';
     var errorMessage = 'Customer Not Found!';
     return new Promise(function(resolve,reject){
        if(user){
            setTimeout(resolve,2000,user);
        }else{
            setTimeout(reject,2000,errorMessage)
        }
     });
   
}
getCustomer().then(function(res){
    console.log(res);
}).catch(function(res){
    console.log(res);
 })
 .finally(function(){
     console.log('customer finally')
 });


Promise hell:
 if we consumes promises, we need to process with multi then and catch.

async await: 
 it is abstraction for handling promises in
 

//async..await
/**
 * async is keyword used infront of function : async function
 * async function by default may return Promise.resolve
 */
async function getDefaultData(){
    return 'Hello'; //Promise.resolve('Hello');
}
getDefaultData().then(function(res){
    console.log(res);
})
// async function getError(){
//     return Promise.reject('something went wrong');
// }
// getError().catch(function(err){
//     console.log(err);
// })
///////////////////////////////////////////////////////////////////////////////////
//callee

function  getUser(){
      //mock data
      var user = 'admin';
      var errorMessage = 'User Not Found!';
      if(user){
           return Promise.resolve(user)
      }
      return Promise.reject(errorMessage)  
}
function login(user){
    var errorMessage = 'Login failed';
    var successMessage ='Login success';
    if(user === 'admin'){
        return Promise.resolve(successMessage)
    }
    return Promise.reject(errorMessage)      
}
//caller 
async function process(){
    // getUser().then(function(res){
    //     console.log(res)
    // }).catch(function(err){
    //     console.log(err);
    // })

 try{
    var user = await getUser();
    //call login method
    var status = await login(user);
    console.log(status)
 }
 catch(err){
     console.log(err)
 }
 finally{
     console.log('finally')
 }

}
process();

********************************************************************************************
Typescript:
...........

What is typescript?

 Typescript scales javascript.
 scales -Expanding the features of javascript.

javascript and entrise computing:

1.js is type less /dynamic typed language.
2.js is not object oriented , object  base.


How to make object oriented javascript?


---In 2012 , javascript team : ECMA Committte provided a spce
 -ES 6 Spec - new version of javascript.

es6 features
1.class
2.arrow functions
3.Promise
4.async and await keywords
......

2012 - ms started a project on es 6 + typing + extra features = typescript.

Typescript is super set of javascript.

Typescript:

1.it is language, cant be exectued on browser/node directly
  we need to compile into javascript.

hello.ts ---compile----hello.js---execute.

********************************************************************************************

Typescript project:

1.compiler - is npm dependency

src/ source code - filename.ts

build / compiled code - filename.js

if you want to change compiler setting , compiler offers lot configuration ; compiler configuration.

tsc --options
******************************************************************************************


Type standards:

 type script has been written on ES 6 ,Which is modern java script standard.

Variable declaration;

var  - ES 5

let,const  - ES 6 - Recommended keywords

var vs let/const.

es 6----compiler(transpilers)--->ES 5
        babel

typescript -tsc------|by default converts -ES 5 Standard


//let keyword

let firstName="Subramanian";
let lastName="Murugan";
//strings : "" , '' , ``(backtick)

//backtick : multi line, string concatnation
console.log(" Name " + firstName + lastName)
console.log(`Name ${firstName} ${lastName}`)
//multiline
let html="<html>"+
         "</html>"
let title = "Protractor App";
let htmlDoc =`
       <html>
          <title>${title}</title>
          <body>Test</body>
       </html>

`;
console.log(htmlDoc)

let age =18;
let isValid =true;
let empty;
//*********************************************************************************
let message = "Hello";
console.log(message);
//reinitalize the message
message="Welcome";
console.log(message);

//const ; cant be reinitalized
const PI = 3.14;
console.log(PI);
//PI =89.89;
********************************************************************************************

Type system:

 Typescript offers rich type system to write better javascript 
 Typescript compilers give warning when you change type.

Typescript types:

1.string
2.number
3.boolean
4.object
5.function
6.void
7.undefined
8.null
9.any
10.enum


//functions and types: Advanced functions

//args and returns

function sayHello(name:string):string {
   //console.log(`Name ${name}`);
   return `Hello ${name}`;
}
sayHello('Subramanian');
//sayHello();
//sayHello(10)
//default args : from es6
// optional args ; from typescript ? 
function greeter(name:string,message:string='Hai',location?:string):string{
    return `${message} ${name}  ${location}`;
}
let result;
result=greeter('Bhava',"Hello")
console.log(result);
//
result=greeter('Bhava');
console.log(result);

function doStuff(myvar:string|number){
     console.log(myvar);
}
doStuff("10");
doStuff(10);
//doStuff(true);

function calculate(a:number|string,b:number|string){
    let result :any;
    if(typeof a ==='string' && typeof b ==='string'){
        result = a + b;
    }
    //dosomething
    result = a + b;
    return result;
}
    
console.log(calculate(10,"10"));


//function declaration.

//es5 old syntax
let greeter = function(){
   console.log('Greeter');
};
greeter();
//Arrow functions 
let greetMe = () => {
    //function body
    console.log('greetMe -arrow ');
 };
 greetMe();
//Flavours of arrow function
//1.if function body has only one line of code, drop {}
let sayHello = () =>console.log('sayHello '); 
sayHello();
//functions with two args,with default /optional parameters,single line of body
let sayHai = (message:string='Hai',name?:string)=>console.log(`${message} ${name}`);
sayHai('Hello','Subramanian');

//functions with return value:
let sum;
sum =():number=>{
    return 10  +10;
};
console.log(sum())

//if function body has only return statement. drop return statement and {}
sum =():number=>30+10;
console.log(sum())

//single variable parameter no type,no default, return the same: drop ()
let getStock = stock =>stock;
console.log(getStock(10))

//*********************************************************************************
//Functions as parameter

function delay(callback){
    setTimeout(callback,1000,"Hello");
}
delay(function(data){
    console.log(data);
});
//pass arrow function
delay(data=>console.log(data));

//function declaration with arrow
const sleep = callback=>setTimeout(callback,1000,"Hello");
sleep(data=>console.log(data));

const getUser = (resolve,reject)=>{
    let user='subramanian';
    if(user){
        setTimeout(resolve,1000,user);
    }
    else{
        setTimeout(reject,1000,"Something went wrong!!!");
    }
}
getUser(res=>console.log(res),err=>console.log(err));

*********************************************************************************************

Object oriented concepts:

1.class
2.object and its type
3.encapulation
4.Object hierachies - dependency injection,inheritance
5.modularity - es 6.

/**
 * Object creation:
 *  ->constructor pattern
 *     -new 
 *       -function - es 5
 *       -class
 *  ->literal pattern
 */

 //es 5 Object : state + methods
 function Employee(){
     //state
     this.id =1;
     this.firstname='subramanian';
     //methods
     this.calculateSalary = function(){
         return 1000;
     }
 }
 //create /instante object
 let emp = new Employee();
 console.log(emp.id,emp.firstname,emp.calculateSalary());

 //es 6 class/type script class
 /**
 class User{
     //state
     firstName:string='Subramanian';
     lastName:string ='Murugan';
     id:number = 1;
     //methods
     login():boolean{
        return true;
     }
 }
 let user = new User();
console.log(`${user.id}  ${user.firstName} ${user.lastName}`)
**/
//how to initalize the state variables
///hardcoded,after object creation , through constructors
/**
class User{
    //state
    firstName:string='Subramanian';
    lastName:string ='Murugan';
    id:number = 1;
    //methods
    login():boolean{
       return true;
    }
}
let user = new User();
//state reinitalize
user.id =90;
user.firstName="John";
user.lastName="James"
console.log(`${user.id}  ${user.firstName} ${user.lastName}`)
**/
class User{
    //state
    firstName:string;
    lastName:string;
    id:number;
    constructor(id:number,firstName:string,lastName?:string){
       //initalize through constructor
       this.id = id;
       this.firstName= firstName;
       this.lastName = lastName;
    }
    //methods
    login():boolean{
       return true;
    }
}
// //state reinitalize
let user = new User(12,'Subramanian','Murugan');
console.log(`${user.id}  ${user.firstName} ${user.lastName}`)



/**
 * Object creation:
 *  ->constructor pattern
 *     -new 
 *       -function - es 5
 *       -class
 *  ->literal pattern
 */
//literal pattern : to represent models biz objects like product,payment,customer

//Object types ;
/**
 * 1.class as type 
 * 2.interface as type
 * 3.type key word
 */

 //class type
//  class Employee{
//      id:number;
//      name:string;
//      isActive?:boolean;
//  }
// interface Employee{
//      id:number;
//      name:string;
//      isActive?:boolean; 
// }

type Employee = {
     id:number;
     name:string;
     isActive?:boolean;
}

const emp:Employee = {
    id:1,
    name:'Subramanian',
    isActive: true
}
console.log(emp)

const emp1:Employee = {
    id:1,
    name:'Subramanian',
}
**********************************************************************************************

Generics:
 Type Erasor

 List<String> list = new ArrayList();
 list.add("Hello");
  
Generics and typescript:

1.Arrays uses generics

 array "of"




 class Employee{
     id:number;
     name:string;
     isActive?:boolean;
 }
function getEmployee():Promise<Employee>{
   let employee:Employee= {
        id:1,
        name:'Subramanian',
        isActive: true
    }
    return Promise.resolve(employee);
}

//return Promise of array of employees
//findAll():Promise<Employee[]> | findAll():Promise<Array<Employee>>
function findAll():Promise<Array<Employee>> {
    const empList:Array<Employee> = [{
        id:1,
        name:'Subramanian',
        isActive: true
    },
    {
        id:1,
        name:'Subramanian',
        isActive: true
    }
    ];
    return Promise.resolve(empList);
}


async function process(){
   const emp = await getEmployee();
   const list = await findAll();
   console.log(emp);
   console.log(list);
}
process();

 
/**
 * Encapsulation :
 *   private,public protected ; state + methods
 *  private : within class
 * public : any where
 *  protected : private within class and public in inheritance
 * Note: default modifier is public with keyword
 */

 //public , private 
 /** 
 class User{
    //state
    public firstName:string='Subramanian';
    public lastName:string ='Murugan';
    id:number = 1;
    private token:string ='ABBB#$#A4A';
    //methods
    public login():boolean{
       if(this.token){
           return true;
       }
       return false;
    }
}
let user = new User();
console.log(`${user.id}  ${user.firstName} ${user.lastName} ${user.login()}`)
**/

//state declartion elemination in using access modifiers
//constructor args are in general is local variables , ts offers a facility that
//local variables can be converted into instance variables , by adding access modifiers
//since these variables are instance variables , we can remove initalization
class User{
      
    constructor(public id:number = 1,public firstName:string='Subramanian', public lastName:string ='Murugan';
    private token:string ='ABBB#$#A4A'){ }
    //methods
    public login():boolean{
       if(this.token){
           return true;
       }
       return false;
    }
}
let user = new User(23,'foo','bar','token');
console.log(`${user.id}  ${user.firstName} ${user.lastName} ${user.login()}`)
//////////////////////////////////////////////////////////////////////////////////////////////

Hierachy : has-a dependency injection.
//inheritance
/**
 * 1.class based
 *    -concrete class
 *    -abstract classes
 * 2.interface base
 */

 interface InterestCalculator{
     calcualteInterest(amount:number,noofyears:number):number;
 }

 abstract class Account{
    constructor(){
        console.log('account is intialized')
    }
    abstract deposit(amount:number):string;
    //
    protected withdraw():number{
        return 10;
    }
 }
 class SavingsAccount extends Account implements InterestCalculator{
    constructor(){
        super();
        console.log('savings account is intialized')
    }
    //override
    public withdraw():number{
        return 1000 * super.withdraw();
    }
    public deposit(amount:number):string{
         return `${amount} has been deposited`
    }
    calcualteInterest(amount:number,noofyears:number):number{
           return amount * 9.5/100 * noofyears;
    }
 }
 let sb = new SavingsAccount();
 console.log(sb.withdraw(), sb.calcualteInterest(1000,2),sb.deposit(12000));










































 


















































Type script


Protractor